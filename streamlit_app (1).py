<INSERT FULL CODE FROM EARLIER HERE>